# 標準出力
## 単純出力
ここで説明するのは単に TOS を出力するだけのワードです。
書式付きの出力についてはこの後説明します。

ワード . （ドットまたはピリオド）は TOS を
表示するものです。
参照型の @. というワードもあります。

. や @. は、プログラムの動作確認やデバッグ時など、
プログラマと Paraphrase との間でのやりとりで
使用されることを想定しています。
そのため、連続で値を表示した場合においても見やすく
表示するために空白も合わせて表示するような
仕様になっています。

アプリケーションとしてプログラムを作る場合には、
自動的に空白を付与して欲しくないばあいもあります。
そのような用途に利用できるワードとして
write があります。

改行を出力するためには cr というワードを利用します。
ワード . と組み合わせることも多いので、
.cr というワードも用意されています。
このワードは TOS の値を表示し改行する、
といった処理を行います。

単純出力に関するワードとして、少し変わった動作を
行うものとして putc というものがあります。
このワードは TOS を文字コードとして、
その文字コードで示される文字を 1 文字出力するといった
ワードです。

<[dl-table-hr-begin]>
<[dl-table-item ワード名]>
<[ddt]>
<[gt]>
<[ref dot .]> , <[ref ref_dot @.]> , <[ref write]> , 
<[ref dot-cr .cr]> , <[ref putc]> , <[ref cr]>
<[/gt]>
<[/ddt]>
<[dl-table-item 実行レベル]>
<[ddt]>標準実行レベル<[/ddt]>
<[dl-table-item スタックの変化]>
<[ddt]>
putc と cr 以外のワードは X --- <[br]>
putc は I --- <[br]>
cr は --- <[br]>
<[/ddt]>
<[dl-table-item 使用例]>
<[ddt]>
write を使うと余分な空白が入りません。
<[code-begin]>
&gt; "A" 1 write write cr
1A
  ok.
<[code-end]>
<[br]>
. の場合は空白が自動的に入ります。
<[code-begin]>
&gt; "A" 1 . . cr 
1 A
  ok.
<[code-end]>
<[br]>
次の例では TOS にある 65 という値を文字に変換し
（ASCII コードで 65 は A という文字）、標準出力へ出力します。
<[code-begin]>
&gt; 65 putc 
  A ok.
<[code-end]>
<[/ddt]>
<[dl-table-item エラー]>
<[ddt]>
cr 以外のワードはスタックが空の場合はエラーとなります。
また、putc については TOS の値が整数でなければ
エラーとなります。
cr についてはエラーは発生しません。
<[/ddt]>
<[dl-table-hr-end]>

## 書式付き出力
C 言語にある printf のように、
書式付きで各種の値を標準出力に出力できます。
C の printf と同様の書式指定に対応した、
printf というワードもありますが、
まずは putf というワードを紹介します。

<[dl-table-hr-begin]>
<[dl-table-item ワード名]>
<[ddt]> <[gt]> <[ref putf]> <[/gt]> <[/ddt]>
<[dl-table-item 実行レベル]>
<[ddt]>標準実行レベル<[/ddt]>
<[dl-table-item スタックの変化]>
<[ddt]> X S --- <[/ddt]>
<[dl-table-item 機能]>
<[ddt]>
putf はセカンドに格納されている値を、
TOS に格納されている書式を用いて
標準出力へ出力します。
書式の指定方法は C の printf と同じです。
このワードは、() @push-back @push-back printf と同等です。
<[br]><[br]>
<[/ddt]>
<[dl-table-item 使用例]>
<[ddt]>
次の例では、TOS にある 123 という値を
書式付きで出力するために、
書式を表す文字列とスタックに積み、
その後 putf を呼び出しています。
<[code-begin]>
&gt; 123
  ok.
&gt; "TOS=%5d\n" putf
TOS= 123
  ok.
<[code-end]>
<[/ddt]>
<[dl-table-item エラー]>
<[ddt]>
スタックに 2 つの値が積まれていない場合はエラーとなります。
また、TOS が文字列でない場合もエラーとなります。
<[/ddt]>
<[dl-table-hr-end]>

putf ではスタック上の値を 1 つだけ出力できました。
何度も putf を呼び出すことにより、
複数の値を出力することももちろん可能です。
しかし、プログラムを作成していると、
複数の値をまとめて出力したいという状況も存在します。
そのような場合には、次に示す printf というワードが
役立つと思います。

ワード printf は TOS にあるリストを取り出し、
そのリストに対し処理を行います。
このリストは、
最初の要素に C 言語で使用する printf の
第 1 要素として指定される書式を示す文字列である必要があります。 リストの 2 番目以降の要素は、この書式で必要とされる 各種の値とします。 書式に使用される文字列は、C 言語の printf の説明を 適宜参照して下さい。
リストの 2 番目以降の要素は、
この書式で必要とされる各種の値が含まれているものとします。
具体的には、( "(x,y)=(%d,%d)\n" 123 456 ) 等といった形の
リストが積まれていることを printf では想定しています。
なお、リストの最初の要素で使用される書式の指定方法は
C 言語の printf で用いられるものと同様ですので、
適宜 C 言語の資料を参照して下さい。

まだ詳しい説明はしていませんが、
Paraphrase には局所変数（ローカル変数）が存在します。
2 番目以降の要素としてシンボルが存在する場合、
そのシンボルと同名の局所変数に保持されている値が
このワードの評価対象となります。
例えば、ローカル変数 x に 10 が代入されている場合、
( "score is %d\n" x ) は ( "score is %d\n" 10 ) として
評価されます。

先程示した例の場合、局所変数 x と y に整数値が
格納されているのであれば、
( "(x,y)=(%d,%d)\n" x y ) printf 等といった形で
書式付き出力が可能となります。

本ワードは boost::format を用いて実装されているため、
2 番目以降の要素の型が分からない場合は、
書式指定部分に %1% などを用いる事ができます。
この書式におけるパーセント記号の間の数値は
書式指定される値の順序を表します。
例えば、
( "a=%1% b=%2% c=%3%" "one" 222 ( third-is-a-list ) ) printf
は、a=one b=22 c=( third-is-a-list ) という出力を行います。

また、引数の順序を指定する本形式では、
任意の位置で利用できるため、
( "%1% %2%,%1% %3%" 'NO' 'PAIN' 'GAIN' ) printf は
NO PAIN, NO GAIN と出力します。

なお、この方法は上で示した C 言語の printf の書式指定と
同時に使用することはできませんので注意して下さい。

<[dl-table-hr-begin]>
<[dl-table-item ワード名]>
<[ddt]><[gt]><[ref printf]><[/gt]><[/ddt]>
<[dl-table-item 実行レベル]>
<[ddt]>標準実行レベル<[/ddt]>
<[dl-table-item スタックの変化]>
<[ddt]> R --- <[/ddt]>
<[dl-table-item 使用例]>
<[ddt]>
次の例では、リスト内に含まれている身長・体重を
表示しています。
<[code-begin]>
&gt; ( "身長:%6.1f 体重:%6.2f\n" 180.5 76.4 ) printf 
身長: 180.5 体重: 76.40
  ok.
<[code-end]>
<[/ddt]>
<[dl-table-item エラー]>
<[ddt]>
スタックが空であったり、TOS がリストでなかったり、
TOS に格納されているリストの 1 番目の要素が
文字列でなかったりした場合はエラーとなります。
また、指定した書式が 2 番目以降の値を必要としている場合に、
対応する値が無かったり、
書式中の書式指定子と合わない場合もエラーとなります。
<[/ddt]>
<[dl-table-hr-end]>

